<!-- Newsletter Header Banner -->
<div id="header-baner" class="newsletter-header-banner" style="background-image: url('<%= site_url %>/assets/images/newsimg/<%= newsletter.image_url %>');">
    <div class="banner-overlay"></div>
    <div class="container d-flex align-items-center" style="height:100%; position: relative; z-index: 2;">
        <div class="banner-content aos" data-aos="fade-up" data-aos-duration="800">
            <h1 class="newsletter-title text-white mb-3">
                <%= language === "en" ? newsletter.en_sub : newsletter.es_sub %>
            </h1>
            <div class="newsletter-meta text-white">
                <span class="meta-item">
                    <i class="fa fa-user me-2"></i>
                    <%= newsletter.author %>
                </span>
                <span class="meta-divider">|</span>
                <span class="meta-item">
                    <i class="fa fa-calendar me-2"></i>
                    <%= newsletter.published ? new Date(newsletter.published).toLocaleDateString(language === "en" ? "en-US" : "es-ES", { year: 'numeric', month: 'long', day: 'numeric' }) : '' %>
                </span>
            </div>
        </div>
    </div>
</div>
<!-- /Newsletter Header Banner -->

<!-- Newsletter Content -->
<section class="newsletter-content-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 mx-auto">
                <!-- Newsletter Description -->
                <div class="newsletter-description aos" data-aos="fade-up" data-aos-duration="600">
                    <div class="description-content">
                        <%- language === "en" ? newsletter.en_desc : newsletter.es_desc %>
                    </div>
                </div>
                <!-- /Newsletter Description -->

                <!-- Education Materials Section -->
                <% if (newsletter.edu_material) { %>
                    <% 
                        let eduMaterials = [];
                        try {
                            const eduMatArray = JSON.parse(newsletter.edu_material);
                            if (Array.isArray(eduMatArray)) {
                                eduMaterials = eduMatArray;
                            }
                        } catch(e) {
                            console.error('Error parsing edu_material:', e);
                        }
                    %>
                    <% if (eduMaterials.length > 0) { %>
                        <div class="education-materials-section aos mt-5" data-aos="fade-up" data-aos-delay="200" data-aos-duration="600">
                            <h3 class="section-title mb-4">
                                <i class="fa fa-book me-2"></i>
                                <%= component_text.v_document || "Education Materials" %>
                            </h3>
                            
                            <div class="materials-grid">
                                <% eduMaterials.forEach((item, index) => { %>
                                    <% const [type, id] = item.split("_") %>
                                    <div class="material-item aos" 
                                         data-aos="fade-up" 
                                         data-aos-delay="<%= index * 100 %>"
                                         data-aos-duration="500">
                                        <div class="material-card">
                                            <div class="material-icon">
                                                <% if (type === "doc") { %>
                                                    <i class="fa fa-file-pdf"></i>
                                                <% } else if (type === "video") { %>
                                                    <i class="fa fa-video"></i>
                                                <% } else { %>
                                                    <i class="fa fa-file"></i>
                                                <% } %>
                                            </div>
                                            <div class="material-info">
                                                <div class="material-type">
                                                    <%= type === "doc" ? "Document" : "Video" %>
                                                </div>
                                                <div class="material-id">ID: <%= id %></div>
                                            </div>
                                        </div>
                                    </div>
                                <% }) %>
                            </div>
                            <p class="text-muted mt-3">
                                <small><i class="fa fa-info-circle me-1"></i> Education materials will be loaded dynamically based on the newsletter configuration.</small>
                            </p>
                        </div>
                    <% } %>
                <% } %>
                <!-- /Education Materials Section -->

                <!-- QR Code Section -->
                <% if (newsletter_qrcode) { %>
                    <div class="aos mt-5" data-aos="fade-up" data-aos-delay="300" data-aos-duration="600">
                        <div class="qr-code-card">
                            <div class="qr-code-image-wrapper">
                                <div class="qr-code-image">
                                    <img src="<%- newsletter_qrcode %>" alt="QR Code" class="qr-img" width="150%" height="150%" />
                                </div>
                                <div class="qr-code-pulse"></div>
                            </div>
                        </div>
                    </div>
                <% } %>
                <!-- /QR Code Section -->
            </div>
        </div>
    </div>
</section>
<!-- /Newsletter Content -->

<style>
    /* Newsletter Header Banner */
    .newsletter-header-banner {
        min-height: 500px;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        position: relative;
        display: flex;
        align-items: center;
    }

    .banner-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 0, 0, 0.3) 100%);
        z-index: 1;
    }

    .banner-content {
        position: relative;
        z-index: 2;
    }

    .newsletter-title {
        font-size: 3rem;
        font-weight: 700;
        line-height: 1.2;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        margin-bottom: 1rem;
    }

    .newsletter-meta {
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
        font-size: 1.1rem;
    }

    .meta-item {
        display: flex;
        align-items: center;
    }

    .meta-divider {
        opacity: 0.7;
    }

    /* Newsletter Content Section */
    .newsletter-content-section {
        background: #f8f9fa;
    }

    .newsletter-description {
        background: #ffffff;
        border-radius: 12px;
        padding: 40px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        margin-bottom: 30px;
    }

    .description-content {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #333;
    }

    .description-content h1,
    .description-content h2,
    .description-content h3,
    .description-content h4 {
        color: #2c3e50;
        margin-top: 1.5rem;
        margin-bottom: 1rem;
    }

    .description-content p {
        margin-bottom: 1.2rem;
    }

    .description-content img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 1.5rem 0;
    }

    .description-content a {
        color: #007bff;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .description-content a:hover {
        color: #0056b3;
        text-decoration: underline;
    }

    /* Section Title */
    .section-title {
        font-size: 1.8rem;
        font-weight: 600;
        color: #2c3e50;
        display: flex;
        align-items: center;
    }

    /* Education Materials Section */
    .education-materials-section {
        background: #ffffff;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .materials-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .material-item {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
    }

    .material-item.aos-animate {
        opacity: 1;
        transform: translateY(0);
    }

    .material-card {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 10px;
        padding: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        cursor: pointer;
    }

    .material-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 123, 255, 0.2);
        border-color: #007bff;
    }

    .material-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #007bff, #00c6ff);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        flex-shrink: 0;
    }

    .material-info {
        flex: 1;
    }

    .material-type {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 5px;
    }

    .material-id {
        font-size: 0.9rem;
        color: #6c757d;
    }

    /* External Link Section */
    .external-link-section {
        background: #ffffff;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .link-card {
        display: flex;
        align-items: center;
        gap: 20px;
        padding: 20px;
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        border-radius: 10px;
        border-left: 4px solid #2196f3;
    }

    .link-icon {
        width: 60px;
        height: 60px;
        background: #2196f3;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        flex-shrink: 0;
    }

    .link-content {
        flex: 1;
    }

    .link-title {
        font-weight: 600;
        color: #1976d2;
        margin-bottom: 8px;
    }

    .link-url {
        color: #1976d2;
        text-decoration: none;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        transition: all 0.3s ease;
    }

    .link-url:hover {
        color: #0d47a1;
        transform: translateX(5px);
    }

    /* Contact Section */
    .contact-section {
        background: #ffffff;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .contact-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin-top: 20px;
    }

    .contact-info-item {
        display: flex;
        gap: 15px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

    .contact-info-item:hover {
        background: #e9ecef;
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .contact-icon {
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #28a745, #20c997);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        flex-shrink: 0;
    }

    .contact-details h6 {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 8px;
        font-size: 1rem;
    }

    .contact-details p {
        margin: 0;
        color: #6c757d;
        font-size: 0.95rem;
    }

    .contact-details a {
        color: #007bff;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .contact-details a:hover {
        color: #0056b3;
        text-decoration: underline;
    }

    /* QR Code Section */
    .qr-code-section {
        background: #ffffff;
        border-radius: 12px;
        padding: 40px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .qr-code-card {
        text-align: center;
    }

    .qr-code-image-wrapper {
        position: relative;
        display: inline-block;
    }

    .qr-code-image {
        position: relative;
        z-index: 2;
        background: #ffffff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        display: inline-block;
        animation: qrCodeFloat 3s ease-in-out infinite;
    }

    @keyframes qrCodeFloat {
        0%, 100% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-10px);
        }
    }

    .qr-img {
        width: 200px;
        height: 200px;
        display: block;
        border-radius: 8px;
    }

    .qr-code-pulse {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 240px;
        height: 240px;
        border: 3px solid #007bff;
        border-radius: 12px;
        animation: qrPulse 2s ease-out infinite;
        z-index: 1;
    }

    @keyframes qrPulse {
        0% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        100% {
            transform: translate(-50%, -50%) scale(1.2);
            opacity: 0;
        }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .newsletter-title {
            font-size: 2rem;
        }

        .newsletter-meta {
            font-size: 0.95rem;
        }

        .newsletter-description {
            padding: 25px;
        }

        .materials-grid {
            grid-template-columns: 1fr;
        }

        .contact-info-grid {
            grid-template-columns: 1fr;
        }

        .qr-code-section {
            padding: 30px;
        }

        .qr-img {
            width: 180px;
            height: 180px;
        }

        .qr-code-pulse {
            width: 220px;
            height: 220px;
        }
    }

    @media (max-width: 576px) {
        .newsletter-header-banner {
            min-height: 400px;
        }

        .newsletter-title {
            font-size: 1.75rem;
        }

        .newsletter-meta {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }

        .meta-divider {
            display: none;
        }
    }
</style>
